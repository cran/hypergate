<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Package installation</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>This Vignette will walk you through the usage of the Hypergate R package.</p>

<h2>Package installation</h2>

<p>Installing dependencies:</p>

<pre><code class="r">install.packages(c(&quot;sp&quot;, &quot;polyclip&quot;, &quot;rgeos&quot;))
source(&quot;https://bioconductor.org/biocLite.R&quot;)
biocLite(&quot;flowCore&quot;)
</code></pre>

<p>Installing the package from github:</p>

<pre><code class="r">install.packages(&quot;devtools&quot;)
library(devtools)
install_github(repo = &quot;ebecht/hypergate&quot;)
</code></pre>

<pre><code class="r">library(hypergate)
</code></pre>

<h2>Data loading</h2>

<pre><code class="r">data(Samusik_01_subset, package = &quot;hypergate&quot;)
</code></pre>

<p>This loads 2000 datapoints randomly sampled from the <em>Samusik_01</em> dataset (available from FlowRepository accession number FR-FCM-ZZPH). This object is a list which includes as elements</p>

<ol>
<li><p><em>fs_src</em> a flowSet with 1 flowFrame corresponding to the data subset</p></li>
<li><p><em>xp_src</em> a matrix corresponding to the expression of the data subset. Rownames correspond to event numbers in the unsampled dataset. Colnames correspond to protein targets (or other information e.g. events&#39; manually-annotated labels)</p></li>
<li><p><em>labels</em> numeric vector encoding manually-annontated labels, with the value -1 for ungated events. The text labels for the gated populations are availble from FlowRepostiry</p></li>
<li><p><em>regular_channels</em> A subset of colnames(Samusik_01_subset$xp_src) that corresponds to protein targets</p></li>
<li><p><em>tsne</em> A 2D-tSNE ran on the whole dataset and subsampled to 2000 events</p></li>
</ol>

<h2>Specifying the cell subset of interest</h2>

<p>Hypergate requires in particular as its arguments</p>

<ol>
<li><p>an expression matrix (which we have as <em>Samusik_01_subset$xp_src</em>)</p></li>
<li><p>a vector specifying which events to attempt to gate on. This section discusses ways to achieve this point</p></li>
</ol>

<h4>Selection from low-dimensional plot</h4>

<p>We included in the package a function with a rudimentary (hopefully sufficient) interface that allows for the selection of a cell subset of interest from a 2D biplot by drawing a polygon around it using the mouse. Since this function is interactive we cannot execute it in this Vignette but an example call would be as such (feel free to try it):</p>

<pre><code class="r">g = gate_from_biplot(Samusik_01_subset$tsne, &quot;tSNE1&quot;, &quot;tSNE2&quot;)
</code></pre>

<p>For this tutorial we define manually the polygon instead</p>

<pre><code class="r">x = c(12.54, 8.08, 7.12, 12.12, 17.32, 20.62, 21.04, 20.83, 18.07, 
    15.2)
y = c(-10.61, -14.76, -18.55, -20.33, -21.16, -19.74, -14.4, 
    -11.08, -10.02, -9.42)
pol = list(x = x, y = y)
library(&quot;sp&quot;)
gate_vector = sp::point.in.polygon(Samusik_01_subset$tsne[, 1], 
    Samusik_01_subset$tsne[, 2], pol$x, pol$y)
plot(Samusik_01_subset$tsne, pch = 16, cex = 0.5, col = ifelse(gate_vector == 
    1, &quot;firebrick3&quot;, &quot;lightsteelblue&quot;))
polygon(pol, lty = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="Manual selection of a cluster on a 2D t-SNE"/></p>

<h4>Clustering</h4>

<p>Another option to define a cell cluster of interest is to use the output of a clustering algorithm. Popular options for cytometry include <em>FlowSOM</em> (available from Bioconductor) or <em>Phenograph</em> (available from the <code>cytofkit</code> package from Bioconductor). An example call for Rphenograph is below:</p>

<pre><code class="r">require(Rphenograph)
set.seed(5881215)
clustering = Rphenograph(Samusik_01_subset$xp_src[, Samusik_01_subset$regular_channels])
cluster_labels = membership(clustering[[2]])
</code></pre>

<p>In this Vignette we use the simpler kmeans option instead:</p>

<pre><code class="r">set.seed(5881215)
cluster_labels = kmeans(Samusik_01_subset$tsne, 20, nstart = 100)$cluster
</code></pre>

<p>In this example we can see that the kmeans cluster <em>20</em> corresponds to the population we manually selected from the t-SNE biplot</p>

<pre><code class="r">plot(Samusik_01_subset$tsne, col = ifelse(cluster_labels == 20, 
    &quot;firebrick3&quot;, &quot;lightsteelblue&quot;), pch = 16, cex = 0.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="Selection of a cluster from a clustering algorithm output"/></p>

<h2>Running Hypergate</h2>

<p>The function to optimize gating strategies is <code>hypergate</code>. Its main arguments are <code>xp</code> (a numeric matrix encoding expression), <code>gate_vector</code> (a vector with few unique values), <code>level</code> (specificies what value of gate_vector to gate upon, i.e. events satisfying <code>gate_vector==level</code> will be gated in)</p>

<pre><code class="r">hg_output = hypergate(xp = Samusik_01_subset$xp_src[, Samusik_01_subset$regular_channels], 
    gate_vector = gate_vector, level = 1, verbose = FALSE)
</code></pre>

<h2>Interpreting and polishing the results</h2>

<h3>Gating datapoints</h3>

<p>The following function allows to subset an expression matrix given a return from <em>Hypergate</em>. The new matrix needs to have the same column names as the original matrix.</p>

<pre><code class="r">gating_predicted = subset_matrix_hg(hg_output, Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels])
</code></pre>

<pre><code class="r">table(ifelse(gating_predicted, &quot;Gated-in&quot;, &quot;Gated-out&quot;), ifelse(gate_vector == 
    1, &quot;Events of interest&quot;, &quot;Others&quot;))
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">Events of interest</th>
<th align="right">Others</th>
</tr>
</thead><tbody>
<tr>
<td align="left">Gated-in</td>
<td align="right">116</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">Gated-out</td>
<td align="right">10</td>
<td align="right">1874</td>
</tr>
</tbody></table>

<p>Another option, which offers more low-level control, is to examine for each datapoint whether they pass the threshold for each parameter. The function to obtain such a boolean matrix is <code>boolmat</code>. Here our gating strategy specifies <em>SiglecF+cKit-Ly6C-</em>. We would thus obtain a 3-columns x 2000 (the number of events) rows</p>

<pre><code class="r">bm = boolmat(gate = hg_output, xp = Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels])
head(bm)
</code></pre>

<pre><code>##     SiglecF_min cKit_max Ly6C_max
## 20        FALSE     TRUE     TRUE
## 28        FALSE     TRUE     TRUE
## 70        FALSE    FALSE     TRUE
## 110        TRUE    FALSE    FALSE
## 120       FALSE     TRUE    FALSE
## 159       FALSE     TRUE    FALSE
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">Events of interest</th>
<th align="right">Others</th>
</tr>
</thead><tbody>
<tr>
<td align="left">Gated-out because of SiglecF</td>
<td align="right">9</td>
<td align="right">1829</td>
</tr>
<tr>
<td align="left">SiglecF above threshold</td>
<td align="right">117</td>
<td align="right">45</td>
</tr>
</tbody></table>

<h3>Examining the output</h3>

<p>The following function will plot the output of Hypergate. Arguments are</p>

<ol>
<li><p><code>gate</code> an object returned by Hypergate</p></li>
<li><p><code>xp</code> an expression matrix whose columns are named similarly as the ones used to create the <code>gate</code> object</p></li>
<li><p><code>gate_vector</code> and <code>level</code> to specify which events are &ldquo;of interest&rdquo;</p></li>
<li><p><code>highlight</code> a color that will be used to highlight the events of interest </p></li>
</ol>

<pre><code class="r">plot_gating_strategy(gate = hg_output, xp = Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels], gate_vector = gate_vector, 
    level = 1, highlight = &quot;firebrick3&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="Gating strategy"/><img src="data:image/png;base64,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" alt="Gating strategy"/></p>

<p>Another important point to consider is how the F\(\beta\)-score increases with each added channel. This gives an idea of how many channels are required to reach a close-to-optimal gating strategy.</p>

<p>This will identify at which steps the parameters were first activated and optimized:</p>

<pre><code class="r">f_values_vs_number_of_parameters = c(F_beta(rep(TRUE, nrow(Samusik_01_subset$xp_src)), 
    gate_vector == 1), hg_output$f[c(apply(hg_output$pars.history[, 
    hg_output$active_channels], 2, function(x) min(which(x != 
    x[1]))) - 1, nrow(hg_output$pars.history))][-1])
barplot(rev(f_values_vs_number_of_parameters), names.arg = rev(c(&quot;Initialization&quot;, 
    paste(&quot;+ &quot;, sep = &quot;&quot;, hg_output$active_channels))), las = 3, 
    mar = c(10, 4, 1, 1), horiz = TRUE, xlab = &quot;Cumulative F1-score&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="F1-score obtained during optimization when adding parameters"/></p>

<p>This graph tells us that the biggest increase is by far due to SiglecF+, while the lowest is due to Ly6C-.</p>

<h3>Channels contributions</h3>

<p>The previous graph only shows how the F-value evolved during optimization, but what we really want to know is how much each parameter contributes to the final output (sometimes a parameter will have a big impact at the early steps of the optimization but will become relatively unimportant towards the end, if multiple other parameters collectively account for most of its discriminatory power). We use the following function to assess this, which measures how much performances lower when a parameter is ignored. The more the performances lower, the more important the parameter is.</p>

<pre><code class="r">contributions = channels_contributions(gate = hg_output, xp = Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels], gate_vector = gate_vector, 
    level = 1, beta = 1)
barplot(contributions, las = 3, mar = c(10, 4, 1, 1), horiz = TRUE, 
    xlab = &quot;F1-score deterioration when the parameter is ignored&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="Contribution of each parameter to the output"/></p>

<h3>Reoptimize strategy</h3>

<p>Since Ly6C contributes very little, we may want to ignore it to obtain a shorter gating strategy. We could keep the current threshold values for the other parameters, but it is best to re-compute the other thresholds to account for the loss of some parameters.
To do that we use the following function:</p>

<pre><code class="r">hg_output_polished = reoptimize_strategy(gate = hg_output, channels_subset = c(&quot;SiglecF_min&quot;, 
    &quot;cKit_max&quot;), xp = Samusik_01_subset$xp_src[, Samusik_01_subset$regular_channels], 
    gate_vector = gate_vector, level = 1)
</code></pre>

<p>Finally, we get to plot our final strategy:</p>

<pre><code class="r">plot_gating_strategy(gate = hg_output_polished, xp = Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels], gate_vector = gate_vector, 
    level = 1, highlight = &quot;firebrick3&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="Final output"/></p>

<h3>Human-readable output</h3>

<p>Thanks to a nice contribution for SamGG on github, there are three functions that make the outputs more readable:</p>

<pre><code class="r">hgate_pheno(hg_output)
</code></pre>

<pre><code>## [1] &quot;SiglecF+, cKit-, Ly6C-&quot;
</code></pre>

<pre><code class="r">hgate_rule(hg_output)
</code></pre>

<pre><code>## [1] &quot;SiglecF &gt;= 2.21, cKit &lt;= 1.77, Ly6C &lt;= 2.98&quot;
</code></pre>

<pre><code class="r">hgate_info(hg_output)
</code></pre>

<pre><code>##             channels sign comp threshold
## SiglecF_min  SiglecF    +  &gt;=   2.208221
## cKit_max        cKit    -  &lt;=   1.770901
## Ly6C_max        Ly6C    -  &lt;=   2.983523
</code></pre>

<pre><code class="r"># Fscores can be retrieved when the same parameters given to
# hypergate() are given to hgate_info():
hg_out_info = hgate_info(hg_output, xp = Samusik_01_subset$xp_src[, 
    Samusik_01_subset$regular_channels], gate_vector = gate_vector, 
    level = 1)
hg_out_info
</code></pre>

<pre><code>##             channels sign comp threshold     deltaF Fscore1D Fscore
## SiglecF_min  SiglecF    +  &gt;=   2.208221 0.76351765   0.8125 0.8125
## cKit_max        cKit    -  &lt;=   1.770901 0.07988981   0.1294 0.9360
## Ly6C_max        Ly6C    -  &lt;=   2.983523 0.02267769   0.1809 0.9587
</code></pre>

<pre><code class="r"># and formatted readily
paste0(hg_out_info[, &quot;Fscore&quot;], collapse = &quot;, &quot;)
</code></pre>

<pre><code>## [1] &quot;0.8125, 0.936, 0.9587&quot;
</code></pre>

<h2>Final notes</h2>

<p>Some comments about potential questions on your own projects (raised by QBarbier):</p>

<h3>Which channels to use as input?</h3>

<p>Anything that would be relevant for a gating strategy should be used as an input. So usually any phenotypic channel would be included. If you know that you would not use certain parameters on subsequent experiments (for instance if the staining is intracellular and you plan to sort a live population and thus cannot permeabilize your cells), you should exclude the corresponding channels. I usually do not use channels that were used in pre-gating steps (e.g. CD45 for immune cells). Finally, if you plan to use flow cytometry and use hypergate on a CyTOF dataset, you probably want to discard the Cell_length channel.</p>

<h3>How big can the input matrix be?</h3>

<p>It depends on how much RAM your computer has. If that is an issue I suggest downsampling to (e.g.) 1000 positive cells and a corresponding number of negative cells. The <code>hgate_sample</code> function can help you achieve this:</p>

<pre><code class="r">set.seed(123)  ## Makes the subsampling reproducible
gate_vector = Samusik_01_subset$labels
subsample = hgate_sample(gate_vector = gate_vector, level = 5, 
    size = 100)  ## Subsample 100 events from population #5 (Classical monocytes), and a corresponding number of negative events
tab = table(ifelse(subsample, &quot;In&quot;, &quot;Out&quot;), ifelse(Samusik_01_subset$labels == 
    5, &quot;Positive pop.&quot;, &quot;Negative pop.&quot;))
tab[1, ]/colSums(tab)  ## Fraction of subsampled events for positive and negative populations
</code></pre>

<pre><code>## Negative pop. Positive pop. 
##     0.3204976     0.3205128
</code></pre>

<pre><code class="r">xp = Samusik_01_subset$xp_src[, Samusik_01_subset$regular_channels]
hg = hypergate(xp = xp[subsample, ], gate_vector = gate_vector[subsample], 
    level = 5)  ## Runs hypergate on a subsample of the input matrix
gating_heldout = subset_matrix_hg(hg, xp[!subsample, ])  ## Applies the gate to the held-out data
table(ifelse(gating_heldout, &quot;Gated in&quot;, &quot;Gated out&quot;), ifelse(Samusik_01_subset$labels[!subsample] == 
    5, &quot;Positive pop.&quot;, &quot;Negative pop.&quot;))
</code></pre>

<pre><code>##            
##             Negative pop. Positive pop.
##   Gated in             37           192
##   Gated out          1110            20
</code></pre>

</body>

</html>
